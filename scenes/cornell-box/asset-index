#include "uuids.as"

void main(ResourceIndex@ index)
{
  SceneGraphImportSettings importSettings;
  
  importSettings.materialUuids['mirror-roughness-0_0'] = uuids::mirrorRoughness_00;
  importSettings.materialUuids['mirror-roughness-0_1'] = uuids::mirrorRoughness_10;
  importSettings.materialUuids['mirror-roughness-0_2'] = uuids::mirrorRoughness_20;
  importSettings.materialUuids['mirror-roughness-0_3'] = uuids::mirrorRoughness_30;
  importSettings.materialUuids['mirror-roughness-0_4'] = uuids::mirrorRoughness_40;
  importSettings.materialUuids['leftWall'] = uuids::leftWall;
  importSettings.materialUuids['rightWall'] = uuids::rightWall;
  importSettings.materialUuids['wall'] = uuids::wall;
  importSettings.materialUuids['light'] = uuids::lightMaterial;
  
  importSettings.lightUuids['cornellBox-rectAreaLight'] = uuids::cornellBox_rectAreaLight;
  importSettings.lightUuids['cornellBox-roughness-rectAreaLight'] = uuids::cornellBox_roughness_rectAreaLight;
  importSettings.lightUuids['cornellBox-roughness-sphereAreaLight'] = uuids::cornellBox_roughness_sphereAreaLight;

  index.convertSceneGraph(sceneGraphFile: "cornell-box.scene-graph",
                          sourceFile: "cornell-box.blend",
                          settings: importSettings);

  index.convertSceneGraph(sceneGraphFile: "cornell-box-roughness.scene-graph",
                          sourceFile: "cornell-box-roughness.blend",
                          settings: importSettings);
                          
  index.registerSceneLayerFile(uuid: uuids::cornellBoxSceneLayer,
                               file: "cornell-box.scene-layer");
  index.registerSceneLayerFile(uuid: uuids::cornellBoxRoughnessSceneLayer,
                               file: "cornell-box-roughness.scene-layer");
                               
  index.registerSceneFile(uuid: uuids::cornellBoxScene,
                          file: "cornell-box.scene");
  index.registerSceneFile(uuid: uuids::cornellBoxRoughnessScene,
                          file: "cornell-box-roughness.scene");

  
  PlainColorMaterial wallPlainMaterial;
  wallPlainMaterial.smoothness = 0.3;
  wallPlainMaterial.base_color = vec3(0.631, 0.065, 0.050);
  index.registerMaterial(uuid: uuids::leftWall,
                         material: wallPlainMaterial);
  wallPlainMaterial.base_color = vec3(0.14, 0.45, 0.091);
  index.registerMaterial(uuid: uuids::rightWall,
                         material: wallPlainMaterial);
  wallPlainMaterial.base_color = vec3(0.723);
  index.registerMaterial(uuid: uuids::wall,
                         material: wallPlainMaterial);
                         
  PlainColorMaterial lightPlainMaterial;
  lightPlainMaterial.base_color = vec3(0);
  lightPlainMaterial.emission = vec3(1);
  index.registerMaterial(uuid: uuids::lightMaterial,
                         material: lightPlainMaterial);
                         
  PlainColorMaterial mirrorPlainMaterial;
  mirrorPlainMaterial.base_color = vec3(1);
  mirrorPlainMaterial.metal_mask = 1.0;
  mirrorPlainMaterial.smoothness = 1.0;
  index.registerMaterial(uuid: uuids::mirrorRoughness_00,
                         material: mirrorPlainMaterial);
  mirrorPlainMaterial.smoothness = 0.9;
  index.registerMaterial(uuid: uuids::mirrorRoughness_10,
                        material: mirrorPlainMaterial);
  mirrorPlainMaterial.smoothness = 0.8;
  index.registerMaterial(uuid: uuids::mirrorRoughness_20,
                        material: mirrorPlainMaterial);
  mirrorPlainMaterial.smoothness = 0.7;
  index.registerMaterial(uuid: uuids::mirrorRoughness_30,
                         material: mirrorPlainMaterial);
  mirrorPlainMaterial.smoothness = 0.6;
  index.registerMaterial(uuid: uuids::mirrorRoughness_40,
                         material: mirrorPlainMaterial);

  RectAreaLightSource rectAreaLight;
  SphereAreaLightSource sphereAreaLight;
  
  rectAreaLight.size = vec2(0.47, 0.38);
  index.registerLightSource(uuid: uuids::cornellBox_rectAreaLight,
                            light: rectAreaLight);
                            
  rectAreaLight.size = vec2(0.3);
  index.registerLightSource(uuid: uuids::cornellBox_roughness_rectAreaLight,
                            light: rectAreaLight);
  sphereAreaLight.radius = 0.1125;
  index.registerLightSource(uuid: uuids::cornellBox_roughness_sphereAreaLight,
                            light: sphereAreaLight);
}
